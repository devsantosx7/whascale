import{r as n,j as e}from"./v_7_4_3_14_49a76bb0-8cf2-4908-a016-18478b764581.js";import{u as _}from"./v_7_4_3_14_49a76bb0-8cf2-4908-a016-18478b76458120.js";import{a as C}from"./v_7_4_3_14_49a76bb0-8cf2-4908-a016-18478b76458189.js";import{c as G,d as H,e as P,a as $,b as q,s as W,g as K,r as V,m as J}from"./v_7_4_3_14_49a76bb0-8cf2-4908-a016-18478b764581191.js";import{B as N,x as y,D as U,m as X,G as Y,a as Z,p as ee,t as O,b as te}from"./v_7_4_3_14_49a76bb0-8cf2-4908-a016-18478b764581216.js";import{ao as z,n as k}from"./v_7_4_3_14_49a76bb0-8cf2-4908-a016-18478b76458123.js";import{i as w}from"./v_7_4_3_14_49a76bb0-8cf2-4908-a016-18478b76458110.js";import{R as se}from"./v_7_4_3_14_49a76bb0-8cf2-4908-a016-18478b7645816.js";import{S as re}from"./v_7_4_3_14_49a76bb0-8cf2-4908-a016-18478b764581218.js";import{au as B,d1 as ie,bs as ne,d6 as oe,bB as ae}from"./v_7_4_3_14_49a76bb0-8cf2-4908-a016-18478b76458111.js";import{a as ce}from"./v_7_4_3_14_49a76bb0-8cf2-4908-a016-18478b764581154.js";import"./v_7_4_3_14_49a76bb0-8cf2-4908-a016-18478b7645818.js";import"./v_7_4_3_14_49a76bb0-8cf2-4908-a016-18478b76458119.js";import"./v_7_4_3_14_49a76bb0-8cf2-4908-a016-18478b7645817.js";import"./v_7_4_3_14_49a76bb0-8cf2-4908-a016-18478b76458134.js";import"./v_7_4_3_14_49a76bb0-8cf2-4908-a016-18478b7645815.js";import"./v_7_4_3_14_49a76bb0-8cf2-4908-a016-18478b764581121.js";import"./v_7_4_3_14_49a76bb0-8cf2-4908-a016-18478b764581120.js";import"./v_7_4_3_14_49a76bb0-8cf2-4908-a016-18478b7645814.js";import"./v_7_4_3_14_49a76bb0-8cf2-4908-a016-18478b7645813.js";import"./v_7_4_3_14_49a76bb0-8cf2-4908-a016-18478b7645812.js";import"./v_7_4_3_14_49a76bb0-8cf2-4908-a016-18478b7645819.js";const T=Symbol("item"),L={type:"idle"},M={type:"dragging"};function D(t){return t[T]===!0}function le({item:t,index:r,instanceId:d}){return{[T]:!0,item:t,index:r,instanceId:d}}const A=n.createContext(null);function de(){const t=n.useContext(A);return w(t!==null),t}const pe=y({flexGrow:1,whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"});function ue({script:t,index:r}){const{getQuickReply:d}=z(),{setScript:i,deleteScript:m}=C(),{close:b}=k(),{language:h}=_(),g=c=>{c.stopPropagation(),m(r),b()};return e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-[var(--primary-strong)] p-[6px] bg-base-200 rounded-md",children:e.jsx(ce,{size:14})}),t.id.length!==0&&e.jsx("span",{children:e.jsx(B,{type:d(t.id,"type")})}),e.jsx(N,{xcss:pe,children:t.id.length!==0?d(t.id,"titulo"):e.jsx("em",{className:"text-red-500",children:h.selectQuickReply})}),r!==0&&e.jsx("div",{className:"w-10 animate__animated group/item",children:e.jsx("input",{type:"number",className:"w-10 border border-solid rounded-md text-center font-semibold bg-base-200 group-hover/item:border-[var(--primaria)] focus:border-[var(--primaria)]",value:t.timer,min:0,onClick:c=>c.stopPropagation(),onChange:c=>{const j=parseInt(c.target.value);c.target.value.length<=2&&i(r,"timer",j),j<0&&i(r,"timer",0)}})}),e.jsx("span",{className:"animate__animated animate__zoomIn pulse hidden text-red-500 cursor-pointer group-hover:block",onClick:g,children:e.jsx(ie,{size:18})})]})}const me=y({position:"relative"}),ge=y({width:"100%",flexShrink:"0",height:"34px",boxSizing:"border-box",display:"flex",flexDirection:"row",alignContent:"center",justifyContent:"space-between",padding:"space.050",position:"relative",borderWidth:"border.width",borderStyle:"solid",borderRadius:"8px",cursor:"grab"}),xe=y({paddingBlock:"space.050",paddingInline:"space.100",borderRadius:"border.radius.100",maxWidth:"360px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}),fe=y({opacity:.4});function he({item:t,index:r,position:d}){const{getQuickReply:i}=z(),{open:m}=k(),{setScript:b,quickReply:h}=C(),{registerItem:g,instanceId:x}=de(),c=n.useRef(null),[j,s]=n.useState(null),p=n.useRef(null),[f,o]=n.useState(L);n.useEffect(()=>{const a=c.current,u=p.current;w(a),w(u);const I=le({item:t,index:r,instanceId:x});return G(g({itemId:t.id,element:a}),q({element:u,getInitialData:()=>I,onGenerateDragPreview({nativeSetDragImage:v}){W({nativeSetDragImage:v,getOffset:ee({x:O("space.200","16px"),y:O("space.100","8px")}),render({container:S}){return o({type:"preview",container:S}),()=>o(M)}})},onDragStart(){o(M)},onDrop(){o(L)}}),H({element:a,canDrop({source:v}){return D(v.data)&&v.data.instanceId===x},getData({input:v}){return $(I,{element:a,input:v,allowedEdges:["top","bottom"]})},onDrag({self:v,source:S}){if(S.element===a){s(null);return}const R=P(v.data),E=S.data.index;w(typeof E=="number");const F=r===E-1,Q=r===E+1;if(F&&R==="bottom"||Q&&R==="top"){s(null);return}s(R)},onDragLeave(){s(null)},onDrop(){s(null)}}))},[x,t,r,g]);const l=a=>{m(e.jsx(re,{ignoredIds:h.script.map(u=>u.id),ignoredTypes:["script"],onSelect:({id:u})=>b(r,"id",u)}),{placement:"left-end"},document.getElementById(`script_${t.id}`),10,{mounted:()=>document.getElementById(`script_${t.id}`)?.classList.add("!border-[var(--primaria)]"),desmouted:()=>document.getElementById(`script_${t.id}`)?.classList.remove("!border-[var(--primaria)]")})};return e.jsxs(n.Fragment,{children:[e.jsxs(N,{ref:c,xcss:me,children:[e.jsx(U,{trigger:({triggerRef:a,...u})=>e.jsx("div",{className:"group",ref:X([p,a]),...u,onClick:l,"style-inject":"grid-atlassian",children:e.jsx(Y,{id:`script_${t.id}`,alignItems:"center",columnGap:"space.100",templateColumns:"auto 1fr auto",xcss:[ge,f.type==="dragging"&&fe],children:e.jsx(ue,{script:t,index:r})})})}),j&&e.jsx("div",{className:"tema-indicador",children:e.jsx(Z,{edge:j,gap:"1px"})})]}),f.type==="preview"&&se.createPortal(e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"ml-2",children:e.jsx(B,{type:i(t.id,"type")})}),e.jsx(N,{xcss:xe,children:i(t.id,"titulo")})]}),f.container)]})}function ve({index:t,items:r}){return r.length===1?"only":t===0?"first":t===r.length-1?"last":"middle"}function be(){const t=new Map;function r({itemId:i,element:m}){return t.set(i,m),function(){t.delete(i)}}function d(i){return t.get(i)??null}return{register:r,getElement:d}}function je(){const{quickReply:t,sortScript:r}=C(),{close:d}=k(),[{items:i,lastCardMoved:m},b]=n.useState({items:[],lastCardMoved:null}),[h]=n.useState(be);n.useEffect(()=>{b(s=>({...s,items:t?.script||[]}))},[t]);const[g]=n.useState(()=>Symbol("instance-id")),x=n.useCallback(({startIndex:s,indexOfTarget:p,closestEdgeOfTarget:f})=>{const o=K({startIndex:s,closestEdgeOfTarget:f,indexOfTarget:p,axis:"vertical"});o!==s&&(b(l=>{const a=l.items[s];return{items:V({list:l.items,startIndex:s,finishIndex:o}),lastCardMoved:{item:a,previousIndex:s,currentIndex:o,numberOfItems:l.items.length}}}),d(),r({oldIndex:s,newIndex:o}))},[]);n.useEffect(()=>J({canMonitor({source:s}){return D(s.data)&&s.data.instanceId===g},onDrop({location:s,source:p}){const f=s.current.dropTargets[0];if(!f)return;const o=p.data,l=f.data;if(!D(o)||!D(l))return;const a=i.findIndex(I=>I.id===l.item.id);if(a<0)return;const u=P(l);x({startIndex:o.index,indexOfTarget:a,closestEdgeOfTarget:u})}}),[g,i,x]),n.useEffect(()=>{if(m===null)return;const{item:s,previousIndex:p,currentIndex:f,numberOfItems:o}=m,l=h.getElement(s.id);l&&te(l)},[m,h]);const c=n.useCallback(()=>i.length,[i.length]),j=n.useMemo(()=>({registerItem:h.register,reorderItem:x,instanceId:g,getListLength:c}),[h.register,x,g,c]);return e.jsx(A.Provider,{value:j,children:e.jsx("div",{className:"pb-1 flex flex-col gap-[6px]",children:i.map((s,p)=>e.jsx(he,{item:s,index:p,position:ve({index:p,items:i})},s.id))})})}function qe(){const{language:t}=_(),{addScript:r}=C();return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h2",{children:t.script}),e.jsx("div",{className:"cursor-pointer lg:tooltip lg:tooltip-bottom before:!w-[120px]","data-tip":t.scriptIncludeTypingAudio,children:e.jsx("div",{className:"pulse text-[var(--icon)]",children:e.jsx(ne,{size:20})})}),e.jsx("div",{className:"cursor-pointer lg:tooltip lg:tooltip-bottom before:!w-[120px]","data-tip":t.script_reorganize,children:e.jsx("div",{className:"pulse text-[var(--icon)] pb-[2px]",children:e.jsx(oe,{size:17})})})]}),e.jsx("div",{children:e.jsx("h2",{children:t.intervalo})})]}),e.jsx(je,{}),e.jsx("div",{className:"flex justify-center pt-2",children:e.jsx("div",{onClick:r,className:"cursor-pointer lg:tooltip lg:tooltip-top","data-tip":t.addMoreQuickReply,children:e.jsx("div",{className:"pulse",children:e.jsx(ae,{size:30,className:"text-[var(--primaria)]"})})})})]})}export{qe as default};
